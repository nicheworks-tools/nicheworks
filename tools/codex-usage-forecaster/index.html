<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Codex Usage Forecaster | NicheWorks</title>

  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=tools/money-template-checker/index.html:G-57QT78M3JB"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'tools/money-template-checker/index.html:G-57QT78M3JB');
  </script>

  <!-- AdSense -->
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=tools/money-template-checker/index.html:ca-pub-9879006623791275"
    crossorigin="anonymous"></script>

  <link rel="stylesheet" href="./style.css" />
</head>
<body>
  <div class="container">
    <header>
      <div class="topbar">
        <div class="brand">
          <div class="logo">◉</div>
          <div class="titles">
            <h1>Codex Usage Forecaster</h1>
            <p class="tagline">燃費で枠を予測する</p>
          </div>
        </div>
        <div class="actions">
          <div class="lang">
            <a href="./index.html" aria-current="page">JA</a>
            <span>·</span>
            <a href="./en/index.html">EN</a>
          </div>
          <button class="themeBtn" type="button" id="themeToggle" aria-label="Toggle theme">☾</button>
        </div>
      </div>

      <nav class="nav">
        <a href="./index.html" aria-current="page">Dashboard</a>
        <a href="./usage.html">Usage</a>
        <a href="./howto.html">HowTo</a>
      </nav>
    </header>

    <section class="ad" aria-label="広告">
      <p class="label">Ad</p>
      <div class="box"></div>
    </section>

    <main>
      <section class="card">
        <h2>予測</h2>
        <p class="muted small">フィルタ（mode / model / status）をかけた状態で燃費と枯渇予測を計算できる。枠更新（リセット）も推定。</p>

        <div class="kpi" id="kpi">
          <div class="item wide">
            <p class="k">5時間枠：枯渇ETA</p>
            <p class="v" id="kpi5hDeplete">—</p>
            <p class="small" id="kpi5hDepleteSub">—</p>
          </div>

          <div class="item wide">
            <p class="k">5時間枠：次のリセット推定</p>
            <p class="v" id="kpi5hReset">—</p>
            <p class="small" id="kpi5hResetSub">—</p>
          </div>

          <div class="item wide">
            <p class="k">週枠：枯渇ETA</p>
            <p class="v" id="kpiWDeplete">—</p>
            <p class="small" id="kpiWDepleteSub">—</p>
          </div>

          <div class="item wide">
            <p class="k">週枠：次のリセット推定</p>
            <p class="v" id="kpiWReset">—</p>
            <p class="small" id="kpiWResetSub">—</p>
          </div>
        </div>
      </section>

      <section class="card" style="margin-top:12px;">
        <h2>ログを追加</h2>

        <div class="grid two">
          <div class="field">
            <div class="label">5時間枠：現在の使用率（%）</div>
            <input class="input" id="in5h" inputmode="decimal" placeholder="例: 62" />
            <div class="small">画面に出ている「使用した%」をそのまま入れる</div>
          </div>

          <div class="field">
            <div class="label">週枠：現在の使用率（%）</div>
            <input class="input" id="inWeek" inputmode="decimal" placeholder="例: 18" />
            <div class="small">週の上限が厄介なのでここが主戦場</div>
          </div>
        </div>

        <div class="grid two" style="margin-top:10px;">
          <div class="field">
            <div class="label">利用形態（mode）</div>
            <select class="select" id="inMode">
              <option value="cloud">cloud（ChatGPT上のCodex）</option>
              <option value="cli">cli（Codex CLI）</option>
              <option value="local">local（ローカル実行）</option>
              <option value="other">other</option>
            </select>
          </div>

          <div class="field">
            <div class="label">ステータス（任意）</div>
            <select class="select" id="inStatus">
              <option value="unknown">unknown</option>
              <option value="ok">ok</option>
              <option value="warn">warn（残り少）</option>
              <option value="limited">limited / rate-limited</option>
              <option value="cooldown">cooldown</option>
            </select>
          </div>
        </div>

        <div class="grid two" style="margin-top:10px;">
          <div class="field">
            <div class="label">モデル/設定（任意）</div>
            <input class="input" id="inModel" placeholder="例: gpt-5.2 / mini / high" />
          </div>

          <div class="field">
            <div class="label">メモ（任意）</div>
            <input class="input" id="inNote" placeholder="例: 大規模PR / 検索多め / 軽微修正" />
          </div>
        </div>

        <div class="row" style="margin-top:10px;">
          <button class="btn primary" id="btnSave">保存</button>
          <button class="btn" id="btnExport">エクスポート（JSON）</button>
          <button class="btn" id="btnImport">インポート</button>
          <input type="file" id="fileImport" accept="application/json" style="display:none;" />
          <span class="small" id="saveHint"></span>
        </div>
      </section>

      <section class="card" style="margin-top:12px;">
        <div class="noteRow">
          <h2 style="margin:0;">ログ</h2>
          <span class="small dim" id="logCount">—</span>
        </div>

        <div class="filters" aria-label="filters">
          <div class="field">
            <div class="label">Filter: mode</div>
            <select class="select" id="filterMode">
              <option value="">all</option>
            </select>
          </div>

          <div class="field">
            <div class="label">Filter: status</div>
            <select class="select" id="filterStatus">
              <option value="">all</option>
              <option value="unknown">unknown</option>
              <option value="ok">ok</option>
              <option value="warn">warn</option>
              <option value="limited">limited</option>
              <option value="cooldown">cooldown</option>
            </select>
          </div>

          <div class="field">
            <div class="label">Filter: model contains</div>
            <input class="input" id="filterModel" placeholder="例: mini" />
          </div>

          <div class="field">
            <div class="label">Filter: note contains</div>
            <input class="input" id="filterNote" placeholder="例: PR" />
          </div>

          <div class="field" style="min-width:160px;">
            <div class="label">Forecast uses filters</div>
            <select class="select" id="filterAffectsForecast">
              <option value="yes" selected>yes</option>
              <option value="no">no（全ログで予測）</option>
            </select>
          </div>
        </div>

        <div style="overflow:auto;">
          <table class="table" id="logTable">
            <thead>
              <tr>
                <th>日時</th>
                <th>5h%</th>
                <th>週%</th>
                <th>mode</th>
                <th>status</th>
                <th>model</th>
                <th>note</th>
                <th></th>
              </tr>
            </thead>
            <tbody id="logBody">
              <tr><td colspan="8" class="muted">まだログがない</td></tr>
            </tbody>
          </table>
        </div>
      </section>
    </main>

    <footer class="footer">
      <div class="row">
        <span>Donate:</span>
        <a href="https://nicheworks.app/">Ko-fi</a>
        <a href="https://nicheworks.app/">OFUSE</a>
        <span>·</span>
        <a href="https://nicheworks.app/">Other tools</a>
      </div>
      <div class="row" style="margin-top:6px;">
        <span>© NicheWorks</span>
        <span>·</span>
        <span>Local-only (no uploads)</span>
      </div>
    </footer>
  </div>

  <script src="./app.js"></script>
</body>
</html>
