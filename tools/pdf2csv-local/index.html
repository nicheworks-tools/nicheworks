<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <title data-i18n-key="meta.index.title">PDF2CSV Local｜PDF明細・請求書をCSV/Excel変換 | NicheWorks</title>
  <meta name="description" data-i18n-key="meta.index.desc" data-i18n-attr="content" content="PDFの明細書・請求書をブラウザ内でCSV/Excelに変換するローカル完結ツール。アップロード内容は外部送信しません。" />

  <link rel="canonical" href="https://nicheworks.app/tools/pdf2csv-local/" />

  <meta property="og:type" content="website" />
  <meta property="og:title" data-i18n-key="meta.index.title" data-i18n-attr="content" content="PDF2CSV Local｜PDF明細・請求書をCSV/Excel変換 | NicheWorks" />
  <meta property="og:description" data-i18n-key="meta.index.desc" data-i18n-attr="content" content="PDFの明細書・請求書をブラウザ内でCSV/Excelに変換するローカル完結ツール。アップロード内容は外部送信しません。" />
  <meta property="og:url" content="https://nicheworks.app/tools/pdf2csv-local/" />
  <meta property="og:image" content="https://nicheworks.app/assets/ogp.png" />
  <meta name="twitter:card" content="summary_large_image" />

  <link rel="icon" type="image/x-icon" href="/assets/favicon.ico" />
  <link rel="apple-touch-icon" href="/assets/favicon.ico" />

  <!-- AdSense（仕様：削除禁止） -->
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9879006623791275" crossorigin="anonymous"></script>

  <link rel="stylesheet" href="./style.css" />

  <!-- Cloudflare Web Analytics -->
  <script defer
    src="https://static.cloudflareinsights.com/beacon.min.js"
    data-cf-beacon='{"token": "aeec938336694c99bc864cdf859b5e37"}'>
  </script>

  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebApplication",
    "name": "PDF2CSV Local",
    "url": "https://nicheworks.app/tools/pdf2csv-local/",
    "applicationCategory": "UtilityApplication",
    "description": "PDFの明細書・請求書をブラウザ内でCSV/Excelに変換するローカル完結ツール。アップロード内容は外部送信しません。",
    "operatingSystem": "All"
  }
  </script>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-57QT78M3JB"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-57QT78M3JB');
</script>
</head>

<body>
  <header class="nw-header">
    <div class="nw-header-inner">
      <h1 class="nw-title" data-i18n-key="index.title">PDF2CSV Local（ローカル完結PDF→CSV変換）</h1>
      <p class="nw-subtitle" data-i18n-key="index.subtitle">銀行明細・請求書PDFをCSV/Excel向けに整形するローカル変換ツールです。</p>

      <div class="nw-lang-switch" aria-label="Language switch">
        <button type="button" data-lang="ja" class="active">JP</button> /
        <button type="button" data-lang="en">EN</button>
      </div>
    </div>
  </header>

  <main class="nw-main">
    <div class="ad-slot ad-top" data-i18n-key="common.adSlot">広告枠（準備中）</div>

    <p class="nw-note" data-i18n-key="index.note.local">※ローカル完結で動作します。PDFは外部に送信されません。</p>

    <p class="nw-note" data-i18n-key="index.note.docs" data-i18n-html="true">ドキュメント: <a href="./usage.html">使い方</a> / <a href="./howto.html">変換のコツ</a> / <a href="./faq.html">FAQ</a></p>

    <section class="card" aria-label="PDF input">
      <h2 class="card-title" data-i18n-key="index.section.input">PDF入力</h2>

      <div class="upload-grid" id="toolRoot">
        <div class="upload-panel">
          <label class="form-label" data-i18n-key="index.label.drag">PDFをドラッグ＆ドロップ</label>
          <div class="drop-zone" id="dropZone" role="button" tabindex="0" data-i18n-key="index.drop.aria" data-i18n-attr="aria-label">
            <input type="file" id="fileInput" accept=".pdf,application/pdf" hidden />
            <p class="drop-zone-title" data-i18n-key="index.drop.title">ここにPDFをドロップ</p>
            <p class="drop-zone-sub" data-i18n-key="index.drop.sub">またはクリックして選択</p>
          </div>
          <p class="form-hint" data-i18n-key="index.drop.hint">対応: PDF / 30MBまで</p>
        </div>

        <div class="status-panel">
          <label class="form-label" data-i18n-key="index.label.status">ステータス</label>
          <dl class="status-list">
            <div>
              <dt data-i18n-key="index.status.filename">ファイル名</dt>
              <dd id="statusName">-</dd>
            </div>
            <div>
              <dt data-i18n-key="index.status.pages">ページ数</dt>
              <dd id="statusPages">-</dd>
            </div>
            <div>
              <dt data-i18n-key="index.status.size">サイズ</dt>
              <dd id="statusSize">-</dd>
            </div>
          </dl>
          <div class="error-box" id="errorBox" role="alert" hidden>
            <p class="error-what" id="errorWhat"></p>
            <p class="error-how" id="errorHow"></p>
          </div>
        </div>
      </div>

      <div class="form-row">
        <div>
          <label class="form-label" data-i18n-key="index.label.range">ページ範囲</label>
          <input type="text" id="pageRange" class="text-input" data-i18n-key="index.range.placeholder" data-i18n-attr="placeholder" placeholder="例: 1-3,5,7-9" />
          <p class="form-hint" data-i18n-key="index.range.hint">空欄なら全ページ</p>
        </div>
        <div>
          <label class="form-label" data-i18n-key="index.label.output">出力形式</label>
          <div class="form-actions">
            <button type="button" class="primary" id="downloadCsv" data-i18n-key="index.output.csv">CSV</button>
            <button type="button" class="secondary" id="downloadXlsx" data-i18n-key="index.output.excel">Excel</button>
          </div>
        </div>
      </div>

    </section>

    <section class="card" aria-label="Extraction settings">
      <h2 class="card-title" data-i18n-key="index.section.settings">抽出設定</h2>

      <div class="form-row">
        <div>
          <label class="form-label" data-i18n-key="index.mode.label">モード</label>
          <div class="segmented" role="radiogroup" aria-label="Extraction mode">
            <label class="segmented-item">
              <input type="radio" name="extractMode" value="auto" checked />
              <span data-i18n-key="index.mode.auto">Auto</span>
            </label>
            <label class="segmented-item">
              <input type="radio" name="extractMode" value="manual" />
              <span data-i18n-key="index.mode.manual">Manual</span>
            </label>
          </div>
          <p class="form-hint" id="modeNotice" data-i18n-key="index.mode.notice">Manualではプレビュー上で範囲を選択して再抽出できます。</p>
          <div class="manual-controls" id="manualControls" hidden>
            <p class="form-hint" data-i18n-key="index.manual.hint">プレビュー上でドラッグして表エリアを選択し、再抽出してください。</p>
            <div class="manual-actions">
              <button type="button" class="secondary" id="resetSelection" data-i18n-key="index.manual.reset">Reset selection</button>
              <button type="button" class="primary" id="reextractButton" disabled data-i18n-key="index.manual.reextract">Re-extract</button>
            </div>
            <p class="manual-coords" id="selectionCoords">Selection: -</p>
            <p class="form-hint warning" id="manualWarning" data-i18n-key="index.manual.warning" hidden>選択範囲がありません。</p>
          </div>
        </div>
        <div>
          <label class="form-label" for="rowTolerance" data-i18n-key="index.settings.rowTolerance">行の近接判定 (px)</label>
          <input type="number" id="rowTolerance" class="text-input" min="0" step="1" value="4" />
        </div>
        <div>
          <label class="form-label" for="colGapThreshold" data-i18n-key="index.settings.colGap">列のギャップ判定 (px)</label>
          <input type="number" id="colGapThreshold" class="text-input" min="0" step="1" value="14" />
        </div>
      </div>

      <label class="toggle">
        <input type="checkbox" id="headerToggle" checked />
        <span class="toggle-label" data-i18n-key="index.settings.header">先頭行をヘッダー扱い</span>
      </label>

      <div class="form-actions align-center">
        <button type="button" class="primary" id="extractButton" disabled data-i18n-key="index.settings.extract">Extract</button>
        <button type="button" class="ghost" id="resetButton" data-i18n-key="index.action.reset">Reset</button>
        <p class="form-hint inline" data-i18n-key="index.settings.extractNote">⏳ 解析は数秒かかる場合があります。</p>
      </div>

      <div class="progress-wrap" id="progressBar" hidden>
        <div class="progress-track">
          <div class="progress-value"></div>
        </div>
        <p class="progress-text" id="progressText" data-i18n-key="index.progress.text">解析中...</p>
      </div>

      <div class="warning-box" id="weakWarning" role="alert" hidden>
        <p data-i18n-key="index.settings.weakWarning">抽出結果が少ないため、Manualモードの使用を検討してください。</p>
      </div>

      <p class="result-summary" id="resultSummary" data-i18n-key="index.settings.resultSummary">抽出結果: -</p>
    </section>

    <section class="card" aria-label="Page preview">
      <h2 class="card-title" data-i18n-key="index.section.preview">ページプレビュー</h2>
      <div class="preview-area">
        <canvas id="pdfPreview" aria-label="PDF preview"></canvas>
        <div class="selection-rect" id="selectionRect" hidden></div>
        <p class="preview-placeholder" id="previewPlaceholder" data-i18n-key="index.preview.placeholder">PDFを読み込むとプレビューが表示されます。</p>
      </div>
    </section>

    <section class="card" aria-label="Result preview">
      <h2 class="card-title" data-i18n-key="index.section.result">抽出結果プレビュー</h2>
      <div class="preview-controls">
        <label class="toggle">
          <input type="checkbox" id="removeEmptyRows" />
          <span class="toggle-label" data-i18n-key="index.preview.removeRows">空行を削除</span>
        </label>
        <label class="toggle">
          <input type="checkbox" id="removeEmptyCols" />
          <span class="toggle-label" data-i18n-key="index.preview.removeCols">空列を削除</span>
        </label>
        <label class="toggle">
          <input type="checkbox" id="csvBomToggle" checked />
          <span class="toggle-label" data-i18n-key="index.preview.bom">CSV BOMを付与</span>
        </label>
        <div class="delimiter-field">
          <span class="form-label small" data-i18n-key="index.preview.delimiter">CSV区切り</span>
          <div class="segmented" role="radiogroup" aria-label="CSV delimiter">
            <label class="segmented-item">
              <input type="radio" name="delimiter" value="comma" checked />
              <span data-i18n-key="index.preview.delimiter.comma">カンマ</span>
            </label>
            <label class="segmented-item">
              <input type="radio" name="delimiter" value="tab" />
              <span data-i18n-key="index.preview.delimiter.tab">タブ</span>
            </label>
          </div>
        </div>
      </div>
      <p class="form-hint" data-i18n-key="index.preview.hint">先頭50行までを表示します。</p>
      <div class="table-scroll">
        <table class="preview-table" id="previewTable" hidden>
          <thead id="previewHead"></thead>
          <tbody id="previewBody"></tbody>
        </table>
        <p class="preview-empty" id="previewEmpty" data-i18n-key="index.preview.empty">抽出するとここに結果プレビューが表示されます。</p>
      </div>
    </section>

    <section class="nw-donate" aria-label="Support">
      <p class="nw-donate-text" data-i18n-key="index.note.donate">このツールが役に立ったら、開発継続のご支援をお願いします。</p>
      <div class="nw-donate-links">
        <a href="https://ofuse.me/nicheworks" target="_blank" rel="noopener">💌 OFUSE</a>
        <a href="https://ko-fi.com/nicheworks" target="_blank" rel="noopener">☕ Ko-fi</a>
      </div>
    </section>

    <div class="nw-links" aria-label="Internal links">
      <span data-i18n-key="index.related.label">関連ツール:</span>
      <a href="/tools/log-formatter/">Log Formatter</a>
      <a href="/tools/rename-wizard/">Rename Wizard</a>
      <a href="/tools/contract-cleaner/">Contract Cleaner</a>
      <a href="/tools/manual-finder/">Manual Finder</a>
    </div>
  </main>

  <footer class="nw-footer">
    <p class="nw-footer-line">© NicheWorks — Small Web Tools for Boring Tasks</p>
    <p class="nw-footer-line" data-i18n-key="common.footer.disclaimer">当サイトには広告が含まれる場合があります。掲載情報の正確性は保証しません。必ず公式情報をご確認ください。</p>
    <p class="nw-footer-line">
      <a href="https://nicheworks.app/" target="_blank" rel="noopener">nicheworks.app</a>
    </p>
  </footer>

  <script src="https://cdn.jsdelivr.net/npm/pdfjs-dist@4.2.67/build/pdf.min.js" crossorigin="anonymous"></script>
  <script src="./vendor/xlsx.full.min.js"></script>
  <script src="./app.js"></script>
</body>
</html>
