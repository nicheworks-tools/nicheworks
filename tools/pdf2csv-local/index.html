<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <title data-i18n-key="meta.index.title">PDF2CSV Local｜PDF明細・請求書をCSV/Excel変換 | NicheWorks</title>
  <meta name="description" data-i18n-key="meta.index.desc" data-i18n-attr="content" content="PDFの明細書・請求書をブラウザ内でCSV/Excelに変換するローカル完結ツール。アップロード内容は外部送信しません。" />

  <link rel="canonical" href="https://nicheworks.pages.dev/tools/pdf2csv-local/" />

  <meta property="og:type" content="website" />
  <meta property="og:title" data-i18n-key="meta.index.title" data-i18n-attr="content" content="PDF2CSV Local｜PDF明細・請求書をCSV/Excel変換 | NicheWorks" />
  <meta property="og:description" data-i18n-key="meta.index.desc" data-i18n-attr="content" content="PDFの明細書・請求書をブラウザ内でCSV/Excelに変換するローカル完結ツール。アップロード内容は外部送信しません。" />
  <meta property="og:url" content="https://nicheworks.pages.dev/tools/pdf2csv-local/" />
  <meta property="og:image" content="https://nicheworks.pages.dev/assets/ogp.png" />
  <meta name="twitter:card" content="summary_large_image" />

  <link rel="icon" type="image/x-icon" href="/assets/favicon.ico" />
  <link rel="apple-touch-icon" href="/assets/favicon.ico" />

  <!-- AdSense（仕様：削除禁止） -->
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9879006623791275" crossorigin="anonymous"></script>

  <link rel="stylesheet" href="./style.css" />

  <!-- Cloudflare Web Analytics -->
  <script defer
    src="https://static.cloudflareinsights.com/beacon.min.js"
    data-cf-beacon='{"token": "aeec938336694c99bc864cdf859b5e37"}'>
  </script>

  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebApplication",
    "name": "PDF2CSV Local",
    "url": "https://nicheworks.pages.dev/tools/pdf2csv-local/",
    "applicationCategory": "UtilityApplication",
    "description": "PDFの明細書・請求書をブラウザ内でCSV/Excelに変換するローカル完結ツール。アップロード内容は外部送信しません。",
    "operatingSystem": "All"
  }
  </script>
</head>

<body>
  <header class="nw-header">
    <div class="nw-header-inner">
      <h1 class="nw-title" data-i18n-key="index.title">PDF2CSV Local（ローカル完結PDF→CSV変換）</h1>
      <p class="nw-subtitle" data-i18n-key="index.subtitle">銀行明細・請求書PDFをCSV/Excel向けに整形するローカル変換ツールです。</p>

      <div class="nw-lang-switch" aria-label="Language switch">
        <button type="button" data-lang="ja" class="active">JP</button> /
        <button type="button" data-lang="en">EN</button>
      </div>
    </div>
  </header>

  <main class="nw-main">
    <div class="ad-slot ad-top" data-i18n-key="common.adSlot">広告枠（準備中）</div>

    <p class="nw-note" data-i18n-key="index.note.local">※ローカル完結で動作します。PDFは外部に送信されません。</p>

    <p class="nw-note" data-i18n-key="index.note.usage" data-i18n-html="true">使い方は <a href="./usage.html">使い方ページ</a> をご覧ください。</p>

    <section class="card" aria-label="PDF input">
      <h2 class="card-title" data-i18n-key="index.section.input">PDF入力</h2>

      <div class="upload-grid" id="toolRoot">
        <div class="upload-panel">
          <label class="form-label" data-i18n-key="index.label.drag">PDFをドラッグ＆ドロップ</label>
          <div class="drop-zone" id="dropZone" role="button" tabindex="0" data-i18n-key="index.drop.aria" data-i18n-attr="aria-label">
            <input type="file" id="fileInput" accept=".pdf,application/pdf" hidden />
            <p class="drop-zone-title" data-i18n-key="index.drop.title">ここにPDFをドロップ</p>
            <p class="drop-zone-sub" data-i18n-key="index.drop.sub">またはクリックして選択</p>
          </div>
          <p class="form-hint" data-i18n-key="index.drop.hint">対応: PDF / 30MBまで</p>
        </div>

        <div class="status-panel">
          <label class="form-label" data-i18n-key="index.label.status">ステータス</label>
          <dl class="status-list">
            <div>
              <dt data-i18n-key="index.status.filename">ファイル名</dt>
              <dd id="statusName">-</dd>
            </div>
            <div>
              <dt data-i18n-key="index.status.pages">ページ数</dt>
              <dd id="statusPages">-</dd>
            </div>
            <div>
              <dt data-i18n-key="index.status.size">サイズ</dt>
              <dd id="statusSize">-</dd>
            </div>
          </dl>
          <div class="error-box" id="errorBox" role="alert" hidden>
            <p class="error-what" id="errorWhat"></p>
            <p class="error-how" id="errorHow"></p>
          </div>
        </div>
      </div>

      <div class="form-row">
        <div>
          <label class="form-label" data-i18n-key="index.label.range">ページ範囲</label>
          <input type="text" id="pageRange" class="text-input" data-i18n-key="index.range.placeholder" data-i18n-attr="placeholder" placeholder="例: 1-3,5,7-9" />
          <p class="form-hint" data-i18n-key="index.range.hint">空欄なら全ページ</p>
        </div>
        <div>
          <label class="form-label" data-i18n-key="index.label.output">出力形式</label>
          <div class="form-actions">
            <button type="button" class="primary" data-i18n-key="index.output.csv">CSV</button>
            <button type="button" class="secondary" data-i18n-key="index.output.excel">Excel</button>
          </div>
        </div>
      </div>

      <div class="form-actions align-center">
        <button type="button" class="primary" id="analyzeButton" disabled data-i18n-key="index.action.analyze">解析開始</button>
        <p class="form-hint inline" data-i18n-key="index.action.note">⏳ この処理は最大3秒ほどかかる場合があります。</p>
      </div>
    </section>

    <section class="card" aria-label="Page preview">
      <h2 class="card-title" data-i18n-key="index.section.preview">ページプレビュー</h2>
      <div class="preview-area">
        <canvas id="pdfPreview" aria-label="PDF preview"></canvas>
        <p class="preview-placeholder" id="previewPlaceholder" data-i18n-key="index.preview.placeholder">PDFを読み込むとプレビューが表示されます。</p>
      </div>
    </section>

    <section class="nw-donate" aria-label="Support">
      <p class="nw-donate-text" data-i18n-key="index.note.donate">このツールが役に立ったら、開発継続のご支援をお願いします。</p>
      <div class="nw-donate-links">
        <a href="https://ofuse.me/nicheworks" target="_blank" rel="noopener">💌 OFUSE</a>
        <a href="https://ko-fi.com/nicheworks" target="_blank" rel="noopener">☕ Ko-fi</a>
      </div>
    </section>

    <div class="nw-links" aria-label="Internal links">
      <span data-i18n-key="index.related.label">関連ツール:</span>
      <a href="/tools/log-formatter/">Log Formatter</a>
      <a href="/tools/rename-wizard/">Rename Wizard</a>
      <a href="/tools/contract-cleaner/">Contract Cleaner</a>
      <a href="/tools/manual-finder/">Manual Finder</a>
    </div>
  </main>

  <footer class="nw-footer">
    <p class="nw-footer-line">© NicheWorks — Small Web Tools for Boring Tasks</p>
    <p class="nw-footer-line" data-i18n-key="common.footer.disclaimer">当サイトには広告が含まれる場合があります。掲載情報の正確性は保証しません。必ず公式情報をご確認ください。</p>
    <p class="nw-footer-line">
      <a href="https://nicheworks.pages.dev/" target="_blank" rel="noopener">nicheworks.pages.dev</a>
    </p>
  </footer>

  <script src="https://cdn.jsdelivr.net/npm/pdfjs-dist@4.2.67/build/pdf.min.js" crossorigin="anonymous"></script>
  <script src="./app.js"></script>
</body>
</html>
