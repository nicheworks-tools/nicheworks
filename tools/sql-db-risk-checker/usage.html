<!doctype html>
<html lang="ja" data-lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <title>Usage｜SQL / DB 実行前リスクチェッカー | NicheWorks</title>
  <meta name="description" content="SQL / DB 実行前リスクチェッカーの使い方。危険度判定・警告・ハイライト・実行前チェックリスト・Pro(買い切り)の復元方法を説明します。" />

  <link rel="canonical" href="https://nicheworks.pages.dev/tools/sql-db-risk-checker/usage.html" />
  <link rel="icon" href="/assets/favicon.svg" />
  <link rel="stylesheet" href="./style.css" />
<script defer
  src="https://static.cloudflareinsights.com/beacon.min.js"
  data-cf-beacon='{"token": "aeec938336694c99bc864cdf859b5e37"}'>
</script>
</head>

<body>
  <main class="container">
    <header class="tool-head">
      <div class="tool-head__row">
        <div>
          <h1 class="tool-title" data-i18n="titleUsage">Usage</h1>
          <p class="tool-desc" data-i18n="descUsage">
            SQLを実行する前に、事故りやすいパターンを検出して止まるための材料を出します（自動修正はしません）。
          </p>
          <p class="mini-note" data-i18n="miniNote">Browser-only / No data is sent.（ブラウザ完結・送信なし）</p>
        </div>

        <div class="lang">
          <button class="lang-btn" type="button" data-lang-btn="ja">JA</button>
          <button class="lang-btn" type="button" data-lang-btn="en">EN</button>
        </div>
      </div>

      <div class="tool-nav">
        <a class="link" href="./index.html" data-i18n="backToTool">← ツールへ戻る</a>
      </div>
    </header>

    <section class="card">
      <h2 data-i18n="sec1Title">1. 何ができる？</h2>
      <ul class="bullets">
        <li data-i18n="s1a">DROP / TRUNCATE / ALTER / GRANT / REVOKE などの危険キーワードを検出します。</li>
        <li data-i18n="s1b">UPDATE / DELETE の WHERE なしを強く警告します（全件更新・全件削除の事故防止）。</li>
        <li data-i18n="s1c">SQL全体に危険箇所ハイライトを付けて見落としを減らします。</li>
        <li data-i18n="s1d">Read-onlyモード（SELECT以外を強警告）でチェックを厳しくできます。</li>
      </ul>
      <p class="note" data-i18n="s1note">
        ※このツールは安全性や実行結果を保証しません。最終判断はあなたが行ってください。
      </p>
    </section>

    <section class="card">
      <h2 data-i18n="sec2Title">2. 使い方（最短）</h2>
      <ol class="steps">
        <li data-i18n="s2a">SQLを貼り付け（複数文OK / <code>;</code> 区切り）</li>
        <li data-i18n="s2b">必要なら Environment / DB Type / Read-only を選ぶ</li>
        <li data-i18n="s2c"><strong>リスクチェック</strong> → Risk Badge と Warnings を確認</li>
        <li data-i18n="s2d">本番なら「実行前チェックリスト」を全部満たしてから実行</li>
      </ol>
    </section>

    <section class="card">
      <h2 data-i18n="sec3Title">3. 警告の見方</h2>
      <ul class="bullets">
        <li data-i18n="s3a"><strong>Critical</strong>：実行すると致命的になり得る（DROP/WHERE無しDELETE等）</li>
        <li data-i18n="s3b"><strong>High</strong>：事故・権限・全件操作の恐れが高い（CASCADE等）</li>
        <li data-i18n="s3c"><strong>Medium</strong>：重い/雑な可能性（SELECT *、LIKE '%...%' など）</li>
        <li data-i18n="s3d"><strong>Low</strong>：危険検出は少ないが、保証ではない</li>
      </ul>
      <p class="note" data-i18n="s3note">
        Prod を選ぶと、同じSQLでも危険度を一段上げる挙動があります（慎重モード）。
      </p>
    </section>

    <section class="card">
      <h2 data-i18n="sec4Title">4. Pro（買い切り）について（MVP仕様）</h2>
      <p data-i18n="s4a">
        Proは「安全実行テンプレ（手順）」などの表示機能です。SQLを自動修正する機能はありません。
      </p>

      <div class="callout">
        <h3 data-i18n="s4b">購入〜復元の流れ</h3>
        <ol class="steps">
          <li data-i18n="s4c">Buy Pro を押して外部の決済ページへ移動</li>
          <li data-i18n="s4d">決済完了後、このツールへ戻る（success_url で <code>?pro=1</code> が付くと自動復元）</li>
          <li data-i18n="s4e">もし自動復元されない場合は「購入済みを復元」を押す</li>
        </ol>
      </div>

      <p class="note" data-i18n="s4note">
        ※現段階はブラウザ内での復元（localStorage）です。将来はサーバ側で支払い検証して復元精度を上げます。
      </p>
    </section>

    <section class="card">
      <h2 data-i18n="sec5Title">5. 実行前チェックリスト（推奨）</h2>
      <ul class="checklist">
        <li data-i18n="c1">対象DBは本番ですか？（Prodなら慎重に）</li>
        <li data-i18n="c2">バックアップ／ロールバック手段はありますか？</li>
        <li data-i18n="c3">影響行数を事前に確認しましたか？（SELECT COUNTなど）</li>
        <li data-i18n="c4">権限は最小限ですか？（必要なロールのみ）</li>
        <li data-i18n="c5">トランザクションで囲むべきですか？（BEGIN/ROLLBACK/COMMIT）</li>
      </ul>
    </section>

    <section class="card">
      <h2 data-i18n="sec6Title">6. 免責</h2>
      <p class="note" data-i18n="disclaimer">
        このツールはSQLの実行結果や安全性を保証するものではありません。本番環境では必ずバックアップ・権限・トランザクションを確認してください。
      </p>
    </section>

    <footer class="footer">
      <p class="donate" data-i18n="donateText">
        このツールが役に立ったら、開発継続のためのご支援をいただけると助かります。
      </p>
      <div class="donate-links">
        <!-- 既存ツールと同じ導線に揃える：URLは共通仕様に合わせて差し替え -->
        <a class="btn" href="#" rel="nofollow noopener" target="_blank">Support (Stripe)</a>
        <a class="btn" href="#" rel="nofollow noopener" target="_blank">Support (Ko-fi)</a>
      </div>
      <p class="tiny">© NicheWorks</p>
    </footer>
  </main>

  <script>
    const $ = (id) => document.getElementById(id);

    const I18N = {
      ja: {
        titleUsage: "Usage",
        descUsage: "SQLを実行する前に、事故りやすいパターンを検出して止まるための材料を出します（自動修正はしません）。",
        miniNote: "Browser-only / No data is sent.（ブラウザ完結・送信なし）",
        backToTool: "← ツールへ戻る",

        sec1Title: "1. 何ができる？",
        s1a: "DROP / TRUNCATE / ALTER / GRANT / REVOKE などの危険キーワードを検出します。",
        s1b: "UPDATE / DELETE の WHERE なしを強く警告します（全件更新・全件削除の事故防止）。",
        s1c: "SQL全体に危険箇所ハイライトを付けて見落としを減らします。",
        s1d: "Read-onlyモード（SELECT以外を強警告）でチェックを厳しくできます。",
        s1note: "※このツールは安全性や実行結果を保証しません。最終判断はあなたが行ってください。",

        sec2Title: "2. 使い方（最短）",
        s2a: "SQLを貼り付け（複数文OK / <code>;</code> 区切り）",
        s2b: "必要なら Environment / DB Type / Read-only を選ぶ",
        s2c: "<strong>リスクチェック</strong> → Risk Badge と Warnings を確認",
        s2d: "本番なら「実行前チェックリスト」を全部満たしてから実行",

        sec3Title: "3. 警告の見方",
        s3a: "<strong>Critical</strong>：実行すると致命的になり得る（DROP/WHERE無しDELETE等）",
        s3b: "<strong>High</strong>：事故・権限・全件操作の恐れが高い（CASCADE等）",
        s3c: "<strong>Medium</strong>：重い/雑な可能性（SELECT *、LIKE '%...%' など）",
        s3d: "<strong>Low</strong>：危険検出は少ないが、保証ではない",
        s3note: "Prod を選ぶと、同じSQLでも危険度を一段上げる挙動があります（慎重モード）。",

        sec4Title: "4. Pro（買い切り）について（MVP仕様）",
        s4a: "Proは「安全実行テンプレ（手順）」などの表示機能です。SQLを自動修正する機能はありません。",
        s4b: "購入〜復元の流れ",
        s4c: "Buy Pro を押して外部の決済ページへ移動",
        s4d: "決済完了後、このツールへ戻る（success_url で <code>?pro=1</code> が付くと自動復元）",
        s4e: "もし自動復元されない場合は「購入済みを復元」を押す",
        s4note: "※現段階はブラウザ内での復元（localStorage）です。将来はサーバ側で支払い検証して復元精度を上げます。",

        sec5Title: "5. 実行前チェックリスト（推奨）",
        c1: "対象DBは本番ですか？（Prodなら慎重に）",
        c2: "バックアップ／ロールバック手段はありますか？",
        c3: "影響行数を事前に確認しましたか？（SELECT COUNTなど）",
        c4: "権限は最小限ですか？（必要なロールのみ）",
        c5: "トランザクションで囲むべきですか？（BEGIN/ROLLBACK/COMMIT）",

        sec6Title: "6. 免責",
        disclaimer: "このツールはSQLの実行結果や安全性を保証するものではありません。本番環境では必ずバックアップ・権限・トランザクションを確認してください。",
        donateText: "このツールが役に立ったら、開発継続のためのご支援をいただけると助かります。",
      },
      en: {
        titleUsage: "Usage",
        descUsage: "Paste SQL before you run it. This page explains how to interpret warnings (the tool never edits your SQL).",
        miniNote: "Browser-only / No data is sent.",
        backToTool: "← Back to the tool",

        sec1Title: "1. What it does",
        s1a: "Detects risky keywords such as DROP / TRUNCATE / ALTER / GRANT / REVOKE.",
        s1b: "Strongly warns on UPDATE/DELETE without WHERE (prevents full-table accidents).",
        s1c: "Highlights risky parts in the SQL preview to reduce misses.",
        s1d: "Read-only mode can flag any non-SELECT statements.",
        s1note: "This tool does not guarantee safety or results. You are responsible for the final decision.",

        sec2Title: "2. Quick steps",
        s2a: "Paste SQL (multiple statements allowed, separated by <code>;</code>)",
        s2b: "Optionally choose Environment / DB Type / Read-only",
        s2c: "<strong>Check Risk</strong> → review Risk Badge and Warnings",
        s2d: "For production, satisfy the checklist before executing",

        sec3Title: "3. Interpreting warnings",
        s3a: "<strong>Critical</strong>: potentially catastrophic (DROP, DELETE without WHERE, etc.)",
        s3b: "<strong>High</strong>: high accident/permission risk (CASCADE, etc.)",
        s3c: "<strong>Medium</strong>: heavy or sloppy query patterns (SELECT *, LIKE '%...%')",
        s3d: "<strong>Low</strong>: fewer hits, not a guarantee",
        s3note: "Selecting Prod can bump the risk level (cautious mode).",

        sec4Title: "4. Pro (One-time) — MVP behavior",
        s4a: "Pro provides display-only features (safe execution templates). It never edits your SQL.",
        s4b: "Purchase & restore flow",
        s4c: "Click Buy Pro → go to an external payment page",
        s4d: "After payment, return to the tool (auto-restore if success_url includes <code>?pro=1</code>)",
        s4e: "If not restored, click “Restore purchase”",
        s4note: "MVP uses browser localStorage. Later we will verify payment on the server for stronger restores.",

        sec5Title: "5. Pre-run checklist (recommended)",
        c1: "Is this production? (Be extra careful for Prod)",
        c2: "Do you have backup / rollback options?",
        c3: "Did you verify affected rows? (e.g., SELECT COUNT)",
        c4: "Are privileges minimized (least privilege)?",
        c5: "Should this be wrapped in a transaction? (BEGIN/ROLLBACK/COMMIT)",

        sec6Title: "6. Disclaimer",
        disclaimer: "This tool does not guarantee execution safety or results. Always verify backups, privileges, and transactions before running SQL in production.",
        donateText: "If this tool helped you, consider supporting ongoing development.",
      }
    };

    function setLang(lang) {
      const l = (lang === "en") ? "en" : "ja";
      document.documentElement.setAttribute("data-lang", l);
      document.documentElement.lang = l;
      localStorage.setItem("nw_lang", l);

      const dict = I18N[l];

      document.querySelectorAll("[data-i18n]").forEach((el) => {
        const key = el.getAttribute("data-i18n");
        if (!dict[key]) return;
        el.innerHTML = dict[key];
      });
    }

    document.addEventListener("click", (e) => {
      const btn = e.target.closest("[data-lang-btn]");
      if (!btn) return;
      setLang(btn.getAttribute("data-lang-btn"));
    });

    (function initLang(){
      const saved = localStorage.getItem("nw_lang");
      setLang(saved || "ja");
    })();
  </script>
</body>
</html>
